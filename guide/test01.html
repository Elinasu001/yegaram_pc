<!DOCTYPE html>
<html lang="ko">
<head>
	<!-- 헤더 -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>예가람저축은행</title>
	<meta charset="utf-8">
	<meta http-equiv="Content-Script-Type" content="text/javascript">
	<meta http-equiv="Content-Style-Type" content="text/css">
	<meta name="keywords" content="예가람저축은행" />
	<meta name="description" content="딴딴해서 믿을 수 있는 예가람저축은행, 예금, 적금, 신용부금, 논스톱 자동대출 등 예금, 대출금융상품 안내" />
	<meta name="viewport" content="width=device-width">
	<meta name="apple-mobile-web-app-status-bar-style" content="white" />
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="mobile-web-app-capable" content="yes">
	<meta property="og:image" content="https://www.yegaramsb.co.kr/resources/images/main/meta-img-square_new.jpg">   
	<link rel="shortcut icon" type="image/x-icon" href="../resources/favicon.ico" />
	<link href="../resources/css/jquery.bxslider.css" rel="stylesheet"f />
	<link href="../resources/css/default.css" rel="stylesheet" />
	<link href="../resources/css/layout.css" rel="stylesheet" />
	<link href="../resources/css/contents.css" rel="stylesheet" />
	<link href="../resources/css/jquery-ui.css" rel="stylesheet" />
	<script src="../resources/js/jquery-1.11.3.min.js"></script>
	<script src="../resources/js/TweenMax.min.js"></script>
	<script src="../resources/js/jquery.bxslider.min.js"></script>
	<script src="../resources/js/placeholders.js"></script>
	<!--     jquery-ui.js가 default.js보다 먼저 선언되어야 함 -->
	<script src="../resources/js/jquery-ui.js" type="text/javascript"></script>
	<script src="../resources/js/default.js"></script>
	<script src="../resources/js/ui.js"></script>
	<script src="../resources/pub_js/ui_pub.js"></script>
	<script type="text/javascript" src="../resources/js/jquery.form.min.js"></script> 
	<script type="text/javascript" src="../resources/js/common_ajax.js"></script>
	<script type="text/javascript" src="../resources/js/common_bank_calc_util.js"></script> 
	<script type="text/javascript" src="../resources/js/common_bank_map_util.js"></script> 
	<script type="text/javascript" src="../resources/js/common_layer.js"></script> 
	<script type="text/javascript" src="../resources/js/common_pagevalidate.js"></script>
	<script type="text/javascript" src="../resources/js/common_util.js"></script> 
	<script type="text/javascript" src="../resources/js/iscroll.js"></script> 
	<script type="text/javascript" src="../resources/js/jquery.animateSprite.min.js"></script>  
	<script src="../resources/js/common_bank_calc_util.js" type="text/javascript"></script>
	<script src="../resources/js/hp_common.js" type="text/javascript"></script>
	<script src="../resources/js/calculator.js"></script>    
	<script src="../resources/js/streamdocs/adapter.js"></script>  	


</head>
<script type="text/javascript">
    var PageFunc = function() {
         
        var _back = function() { // 뒤로가기
            history.back();
        }
        
        var _proc = function() { // 본처리
            
            var actionFlag = false;	// 서비스호출 플래그 
            var imgList = [];
            var list = $("#imgUl > li");
            
            // 이미지 레코드셋 세팅
            $.each(list, function(idx, obj){
                if ($(obj)[0].className != "plus") {
                    var img = $(obj).data("img");
                    imgList.push({"IMG":img});					
                }
                if (list.length == idx+1) actionFlag = true;
            });
            
            // 증빙자료제출 서비스 호출
            if (actionFlag) {
                var reqForm = makeForm("reqForm");
                addFormData(reqForm, "RECORD_IMG", JSON.stringify(imgList));
                addFormData(reqForm, "LVTP_MNBD_DVCD", '${reqDs.LVTP_MNBD_DVCD}'); // 첨부서류구분코드
                doAction("SAV_LMT_MNG", reqForm, function(resDs){
                    var resultForm = makeForm("resultForm");
                    addFormData(resultForm, "ECM_RESULT", resDs.ECM_RESULT);
                    addFormData(resultForm, "API_RS_MSG", resDs.API_RS_MSG);
                    doActionFrame("bnk/mng/txfrCmphSvCert3", resultForm);
                });
                
            }
        }
        
        var _cancel = function() { // 그만하기
            goMainPage();
        }
        
        var _validate = function() { // 유효성검증
            if (finalValidChk()) {
                return true;			
            } else {
                return false;
            }
        }
        
        return {
            back : _back,
            proc : _proc,
            cancel : _cancel
        };
    }();
    
    $(document).ready(function(){
        
    });
    
    var validFlag = true;
    // 카메라호출 및 콜백데이터 세팅
    function callCamera(obj){
        
        
        biz.camera(function(data){
            var imgData = data; // 촬영 데이터 
            if (imgData.indexOf("base64,") > -1) {
                imgData = imgData.substring(imgData.indexOf(',')+1);
            }
            // 썸네일 
            $(obj).closest("li").removeClass("plus");
            $(obj).closest("li").data("img", imgData);
            $(obj).text("");
            var $newForm = document.createElement("img");
            $newForm.src = data;
            $newForm.style = "";
            $(obj).append($($newForm));
            
            var cameraYn = $("#imgUl > li").hasClass("plus"); // 촬영 이미지수 및 촬영버튼 생성
            if (cameraYn) { 
                $("#imgCnt").text(totalCnt -1);
                $("#cnt").val(totalCnt -1);
            } else {	
                $("#imgCnt").text(totalCnt);
                $("#cnt").val(totalCnt);
                if (totalCnt < 10) { // 촬영서류 건수가 10개 미만
                    makeList();		 // 새로운 촬영버튼 생성
                }
            }
            if (validFlag) { // 최초 촬영시에만 유효성체크
                validChk();
                validFlag = false;
            } 
        });
        
    // 	var totalCnt = $("#imgUl > li").length;	// 촬영된 이미지 수
        
    // 	// 최대 10장 촬영가능
    // 	if (totalCnt < 11) {
            
            
    // 	} else {
    // 		biz.alert("최대 10장까지 촬영 가능합니다");
    // 	}
    }
    // 새로운 촬영리스트 생성
    function makeList(){
        var $newForm = document.createElement("li");
        $newForm.className = "plus";
        var format = $("#liFormat").html();
        $($newForm).html(format); 
        $("#imgUl").append($($newForm));
    }
    // 촬영된 서류 삭제
    function removeLi(obj){
        biz.confirm("촬영서류를 삭제하시겠습니까?", function(){
            $(obj).closest("li").remove();
            if ($("#imgUl > li").length < 1) makeList();
        });
    }
    </script>
<body>
<!-- <body class="color-type2"> 타입별 -->
    <!-- ********** Include ********** -->
    <!-- s:skipnavi -->
    <div id="skipnavi">
        <script>
		$(document).ready(function(){
			$("#skipnavi").load("../include/inc_body_skipnavi.html");
		});
		</script>
    </div>
    <!-- ********** //Include ********** -->
    <!-- //e:skipnavi -->

    <!-- s:wrap -->
    <div id="wrap">

    <!-- s contentsWrap -->
        <div id="contentsWrap">
			<div class="contents default-wrap">
                <div class="btn-cont-wrap">
                    <input type="file" accept="image/*" class="cameraimg btn-no" id="" >
                </div>
                <div class="btn-cont-wrap">
                    <input type="button" accept="image/*" class="btn" id="" onclick="callCamera(this);">
                </div>	

            </div>
		</div>
        <!-- //e: contentsWrap -->
    </div>
    <!-- //e:wrap -->
</body>
</html>
